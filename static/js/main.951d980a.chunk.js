(window["webpackJsonpdescentralized-documents"]=window["webpackJsonpdescentralized-documents"]||[]).push([[0],{194:function(e,t,n){"use strict";var a=n(388),r=new(n.n(a).a)({host:"ipfs.infura.io",port:5001,protocol:"https"});t.a=r},270:function(e,t){},383:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return S});var a=n(13),r=n.n(a),s=n(98),i=n(384),o=n(385),c=n(391),u=n(386),l=n(34),d=n(390),f=n(4),h=n.n(f),m=n(392),p=n(195),b=n(100),v=(n(401),n(99)),g=n(194),S=function(t){function n(e){var t;return Object(i.a)(this,n),(t=Object(c.a)(this,Object(u.a)(n).call(this,e))).state={ipfsHash:null,buffer:"",ethAddress:"",formAddress:"0x8e287B1F206eF762D460598bdE1A9C22db6b6382",formIPFS:"",imgUrl:"",statusMsg:"Waiting for submission"},t.captureFile=t.captureFile.bind(Object(l.a)(t)),t.convertToBuffer=t.convertToBuffer.bind(Object(l.a)(t)),t.handleSubmitIPFS=t.handleSubmitIPFS.bind(Object(l.a)(t)),t.handleSubmitSC=t.handleSubmitSC.bind(Object(l.a)(t)),t.setEventListeners=t.setEventListeners.bind(Object(l.a)(t)),t.handleChangeIPFS=t.handleChangeIPFS.bind(Object(l.a)(t)),t.handleChangeAddress=t.handleChangeAddress.bind(Object(l.a)(t)),console.log("contract",v.a),console.log("ipfs",g.a),t}return Object(d.a)(n,t),Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(s.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.signer.getAddress();case 3:t=e.sent,console.log("componentDidMount/userAddress",t),this.setState({ethAddress:t}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("componentDidMount/error",e.t0.message),alert("An error occurred. Could you confirm if your Metamask is open and running?");case 12:this.setEventListeners();case 13:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"setEventListeners",value:function(){var e=this;v.a.on("ipfsSent",function(t,n,a){console.log("setEventListeners/ipfsSent/event",a),n.toUpperCase()===e.state.ethAddress.toUpperCase()&&e.setState({ipfsHash:t,imgUrl:"https://gateway.ipfs.io/ipfs/".concat(t),statusMsg:"Your received a file https://gateway.ipfs.io/ipfs/".concat(t)})})}},{key:"handleChangeAddress",value:function(e){this.setState({formAddress:e.target.value})}},{key:"handleChangeIPFS",value:function(e){this.setState({formIPFS:e.target.value})}},{key:"captureFile",value:function(e){var t=this;e.stopPropagation(),e.preventDefault();var n=e.target.files[0],a=new window.FileReader;a.readAsArrayBuffer(n),a.onloadend=function(){return t.convertToBuffer(a)}}},{key:"convertToBuffer",value:function(){var t=Object(s.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.from(n.result);case 2:a=t.sent,this.setState({buffer:a});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"handleSubmitSC",value:function(){var e=Object(s.a)(r.a.mark(function e(t){var n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({statusMsg:"Submiting IPFS Hash to the Smart Contract"}),e.prev=2,e.next=5,v.a.sendIPFS(this.state.formAddress,this.state.formIPFS);case 5:return n=e.sent,e.next=8,n.wait(1);case 8:1===(a=e.sent).status?(console.log("handleSubmitSC/sucesso/tx",n,a),this.setState({statusMsg:"IPFS file registered to "+this.state.formAddress})):this.setState({statusMsg:"Error when executing sendIPFS contract method"}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),console.error("handleSubmitSC ",e.t0),this.setState({statusMsg:"Error when executing sendIPFS contract method "+e.t0.message});case 16:case"end":return e.stop()}},e,this,[[2,12]])}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmitIPFS",value:function(){var e=Object(s.a)(r.a.mark(function e(t){var n=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),this.setState({statusMsg:"Submiting file to IPFS network"}),e.next=4,g.a.add(this.state.buffer,function(e,t){if(e)return console.error(e.message),void n.setState({buffer:"",statusMsg:e.message});console.log("handleClick/sucesso/ipfsHash",t),n.setState({formIPFS:t[0].hash,statusMsg:"The IPFS hash is https://gateway.ipfs.io/ipfs/"+t[0].hash})});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e="";return this.state.imgUrl.length>10&&(e=h.a.createElement("img",{alt:this.state.imgUrl,src:this.state.imgUrl})),h.a.createElement(m.a,null,h.a.createElement(p.a,null,h.a.createElement(b.a,{lg:"2"},"\xa0"),h.a.createElement(b.a,{lg:"6",md:"auto"},h.a.createElement(m.a,null,h.a.createElement(p.a,null,h.a.createElement(b.a,null,h.a.createElement("h2",null,"1. Add a file to IPFS here"),h.a.createElement("form",{id:"frmFile",className:"scep-form",onSubmit:this.handleSubmitIPFS},h.a.createElement("input",{type:"file",name:"fileToSend",id:"fileToSend",onChange:this.captureFile}),h.a.createElement("br",null),h.a.createElement("button",{type:"submit"},"Send it")))),h.a.createElement(p.a,null,h.a.createElement(b.a,null,h.a.createElement("h2",null,"2. Send notifications here"),h.a.createElement("form",{id:"frmNotifications",className:"scep-form",onSubmit:this.handleSubmitSC},h.a.createElement("div",null,h.a.createElement("div",null,h.a.createElement("label",{for:"receiverAddress"},"Receiver address:"),h.a.createElement("input",{size:"50",type:"text",name:"receiverAddress",id:"receiverAddress",value:this.state.formAddress,onChange:this.handleChangeAddress})),h.a.createElement("div",null,h.a.createElement("label",{for:"ipfsHash"},"IPFS hash:"),h.a.createElement("input",{size:"128",type:"text",name:"ipfsHash",id:"ipfsHash",value:this.state.formIPFS,onChange:this.handleChangeIPFS}))),h.a.createElement("br",null),h.a.createElement("div",null,h.a.createElement("button",{type:"submit"},"Register it"))))))),h.a.createElement(b.a,{lg:"4"},h.a.createElement("br",null),h.a.createElement("hr",null),h.a.createElement("br",null),h.a.createElement("div",null,h.a.createElement("p",null,"Status: ",this.state.statusMsg,h.a.createElement("br",null),e)))))}}]),n}(f.Component)}).call(this,n(0).Buffer)},393:function(e,t,n){e.exports=n(980)},398:function(e,t,n){},401:function(e,t,n){},411:function(e,t){},432:function(e,t){},434:function(e,t){},496:function(e,t){},543:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=543},651:function(e,t){},681:function(e,t){},683:function(e,t){},720:function(e,t){},722:function(e,t){},729:function(e,t){},731:function(e,t){},737:function(e,t){},738:function(e,t){},751:function(e,t){},753:function(e,t){},760:function(e,t){},762:function(e,t){},768:function(e,t){},775:function(e,t){},777:function(e,t){},794:function(e,t){},796:function(e,t){},803:function(e,t){},805:function(e,t){},980:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),s=n(382),i=n.n(s),o=(n(398),n(383));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(o.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},99:function(e,t,n){"use strict";var a=n(193),r=n(387),s=n.n(r),i={address:"0x0be1fac9f474c185c7138f983ac55d9c41635351",abi:[{constant:!1,inputs:[],name:"checkInbox",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,name:"_ipfsHash",type:"string"},{indexed:!1,name:"_address",type:"address"}],name:"ipfsSent",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"response",type:"string"}],name:"inboxResponse",type:"event"},{constant:!1,inputs:[{name:"_address",type:"address"},{name:"_ipfsHash",type:"string"}],name:"sendIPFS",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"}]},o=null;if(window.web3){var c=new s.a(window.web3.currentProvider);try{var u=new a.ethers.providers.Web3Provider(c.currentProvider);o=new a.ethers.Contract(i.address,i.abi,u).connect(u.getSigner())}catch(l){console.log("error connecting to Ethereum via Metamask or other wallet"),console.error(l)}}t.a=o}},[[393,1,2]]]);
//# sourceMappingURL=main.951d980a.chunk.js.map